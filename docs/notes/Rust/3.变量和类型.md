---
title: å˜é‡å’Œç±»å‹
tags: [ Rust ]

---

# å˜é‡

## å˜é‡å£°æ˜

### å±€éƒ¨å˜é‡

å±€éƒ¨å˜é‡å£°æ˜ä¸€å®šæ˜¯ä»¥å…³é”®å­—letå¼€å¤´ï¼Œç±»å‹ä¸€å®šæ˜¯è·Ÿåœ¨å†’å·ï¼šçš„åé¢ã€‚

```rust
let x = 5;       // ä¸å¯å˜å˜é‡
let mut y = 10;  // å¯å˜å˜é‡
```

- `let` å…³é”®å­—ç”¨äºå£°æ˜å˜é‡ã€‚
- `mut` å…³é”®å­—è¡¨ç¤ºå˜é‡æ˜¯å¯å˜çš„ã€‚

### å¸¸é‡

```rust
const MAX_POINTS: u32 = 100_000;
```

- å¸¸é‡ç”¨ `const` å£°æ˜ï¼Œå¿…é¡»æŒ‡å®šç±»å‹ï¼Œä¸”åœ¨æ•´ä¸ªç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä¿æŒä¸å˜ã€‚

### é™æ€å˜é‡

- ä½¿ç”¨`static`å…³é”®å­—æ¥å£°æ˜é™æ€å˜é‡ã€‚
- é™æ€å˜é‡åœ¨æ•´ä¸ªç¨‹åºè¿è¡ŒæœŸé—´å­˜åœ¨ï¼Œæ‹¥æœ‰`static`ç”Ÿå‘½å‘¨æœŸ(æ•´ä¸ªç¨‹åºã€‚
- é™æ€å˜é‡çš„å†…å­˜åˆ†é…åœ¨ç¼–è¯‘æ—¶å®Œæˆï¼ˆä¸ä¼šåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ”¶å›ã€‚
- é»˜è®¤æƒ…å†µä¸‹ï¼Œé™æ€å˜é‡æ˜¯ä¸å¯å˜çš„ï¼›å¯ä»¥ä½¿ç”¨`static mut`å£°æ˜å¯å˜é™æ€å˜é‡ï¼Œä½†éœ€è¦ä½¿ç”¨`unsafe`ä»£ç å—æ¥è®¿é—®å’Œä¿®æ”¹ã€‚
- Â·å…¨å±€å˜é‡å¿…é¡»åœ¨å£°æ˜çš„æ—¶å€™é©¬ä¸Šåˆå§‹åŒ–ï¼›
- å…¨å±€å˜é‡çš„åˆå§‹åŒ–å¿…é¡»æ˜¯ç¼–è¯‘æœŸå¯ç¡®å®šçš„å¸¸é‡ï¼Œä¸èƒ½åŒ…æ‹¬æ‰§è¡ŒæœŸæ‰èƒ½ç¡®å®šçš„è¡¨è¾¾å¼ã€è¯­å¥å’Œå‡½æ•°è°ƒç”¨ï¼›

#### ä¸å¯å˜é™æ€å˜é‡

- å£°æ˜å’Œä½¿ç”¨ä¸å¯å˜é™æ€å˜é‡

    ```rust
    static HELLO_WORLD: &str = "Hello, world!";
    
    fn main() {
        println!("{}", HELLO_WORLD);
    }
    ```

#### å¯å˜é™æ€å˜é‡

- å£°æ˜å’Œä½¿ç”¨å¯å˜é™æ€å˜é‡

    ```rust
    static mut COUNTER: i32 = 0;
    
    fn add_to_counter(value: i32) {
        unsafe {
            COUNTER += value;
        }
    }
    
    fn main() {
        add_to_counter(3);
        unsafe {
            println!("COUNTER: {}", COUNTER);
        }
    }
    ```

#### çº¿ç¨‹å®‰å…¨çš„å¯å˜é™æ€å˜é‡

- ä½¿ç”¨`Mutex`ç¡®ä¿çº¿ç¨‹å®‰å…¨

    ```rust
    use std::sync::Mutex;
    
    static GLOBAL_COUNTER: Mutex<i32> = Mutex::new(0);
    
    fn main() {
        {
            let mut counter = GLOBAL_COUNTER.lock().unwrap();
            *counter += 1;
        }
        println!("GLOBAL_COUNTER: {}", GLOBAL_COUNTER.lock().unwrap());
    }
    ```

## ç±»å‹æ¨å¯¼

- Rust å¯ä»¥è‡ªåŠ¨æ¨å¯¼å˜é‡çš„ç±»å‹ï¼Œä¸éœ€è¦æ˜¾å¼æŒ‡å®šç±»å‹ï¼Œé™¤éç¼–è¯‘å™¨æ— æ³•æ¨å¯¼å‡ºã€‚

### ç±»å‹æ¨å¯¼ç¤ºä¾‹

- ç®€å•å˜é‡çš„ç±»å‹æ¨å¯¼

    ```rust
    let x = 5; // x è¢«æ¨å¯¼ä¸º i32
    let y = 3.14; // y è¢«æ¨å¯¼ä¸º f64
    let is_active = true; // is_active è¢«æ¨å¯¼ä¸º bool
    let name = "Alice"; // name è¢«æ¨å¯¼ä¸º &str
    ```

- æ¨å¯¼æ•°ç»„ç±»å‹

    ```rust
    let numbers = [1, 2, 3, 4, 5]; // numbers è¢«æ¨å¯¼ä¸º [i32; 5]
    ```

### æ˜¾å¼æŒ‡å®šç±»å‹çš„æƒ…å†µ

- å½“ç±»å‹ä¸æ˜ç¡®æˆ–æ— æ³•æ¨å¯¼æ—¶éœ€è¦æ˜¾å¼æŒ‡å®š

    ```rust
    let guess: u32 = "42".parse().expect("Not a number!");
    ```

- ä½¿ç”¨æ³›å‹æˆ–å¤æ‚ç±»å‹æ—¶

    ```rust
    let result: Result<i32, _> = "42".parse();
    ```

## åˆå§‹åŒ–ç»‘å®š Initializing bindings

- åœ¨å£°æ˜å˜é‡æ—¶ç«‹å³ä¸ºå…¶èµ‹å€¼ã€‚

- æ— æ„é€ å‡½æ•°ï¼Œæ— åˆå§‹å€¼

  å¦‚æœä¸èµ‹å€¼ï¼ŒRust æ˜¯ä¸ä¼šè®©æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ²¡æœ‰ç»è¿‡åˆå§‹åŒ–çš„å€¼çš„ã€‚

ä¸¾ä¾‹ï¼š

```rust
fn main() {
    let x: i32;
    println!("The value of x is: {}", x);
}
```

æ„å»ºåå‡ºç°ï¼Œerror

```
use of possibly uninitialized variable: `x`
```

## ä½œç”¨åŸŸ Scope

- å˜é‡åœ¨ç¨‹åºä¸­æœ‰æ•ˆçš„èŒƒå›´ã€‚
- é€šè¿‡èŠ±æ‹¬å·`{}`æ¥å®šä¹‰ä½œç”¨åŸŸã€‚
- å˜é‡è¶…å‡ºä½œç”¨åŸŸæ—¶ä¼šè¢«è‡ªåŠ¨é”€æ¯ã€‚

ç¤ºä¾‹:

- å˜é‡çš„ä½œç”¨åŸŸ

    ```rust
    fn main() {
        let x = 5; // x çš„ä½œç”¨åŸŸå¼€å§‹
        {
            let y = 10; // y çš„ä½œç”¨åŸŸå¼€å§‹
            println!("x: {}, y: {}", x, y);
        } // y çš„ä½œç”¨åŸŸç»“æŸ
        // println!("y: {}", y); // ç¼–è¯‘é”™è¯¯ï¼šy ä¸åœ¨ä½œç”¨åŸŸå†…
        println!("x: {}", x);
    } // x çš„ä½œç”¨åŸŸç»“æŸ
    ```

- åµŒå¥—ä½œç”¨åŸŸ

    ```rust
    fn main() {
        let x = 5;
        {
            let x = x * 2;
            println!("Inner scope x: {}", x); // æ‰“å°: Inner scope x: 10
        }
        println!("Outer scope x: {}", x); // æ‰“å°: Outer scope x: 5
    }
    ```

## éšè— shadowing

- åœ¨åŒä¸€ä½œç”¨åŸŸæˆ–å†…åµŒä½œç”¨åŸŸä¸­é‡æ–°å£°æ˜ä¸€ä¸ªå˜é‡åï¼Œä»¥éšè—å‰ä¸€ä¸ªåŒåå˜é‡ã€‚
- éšè—å…è®¸æ”¹å˜å˜é‡çš„ç±»å‹å’Œå¯å˜æ€§ã€‚

ç¤ºä¾‹

- ç®€å•çš„éšè—

    ```rust
    fn main() {
        let x = 5;
        let x = x + 1; // éšè—äº†ä¹‹å‰çš„ x
        {
            let x = x * 2; // åœ¨åµŒå¥—ä½œç”¨åŸŸä¸­å†æ¬¡éšè— x
            println!("Inner scope x: {}", x); // æ‰“å°: Inner scope x: 12
        }
        println!("Outer scope x: {}", x); // æ‰“å°: Outer scope x: 6
    }
    ```

- æ”¹å˜å˜é‡ç±»å‹å’Œå¯å˜æ€§

    ```rust
    fn main() {
        let spaces = "   ";
        let spaces = spaces.len(); // éšè—å¹¶æ”¹å˜ç±»å‹
        println!("spaces length: {}", spaces);
    
        let mut x = 5; // å¯å˜å˜é‡
        x = 6;
        let x = x; // éšè—å¹¶å˜ä¸ºä¸å¯å˜å˜é‡
        // x = 7; // ç¼–è¯‘é”™è¯¯ï¼šx ç°åœ¨æ˜¯ä¸å¯å˜çš„
    }
    ```

# æ•°æ®ç±»å‹

## åŸºæœ¬æ•°æ®ç±»å‹

### bool

Rust çš„å¸ƒå°”ç±»å‹ç”¨äºè¡¨ç¤ºçœŸæˆ–å‡ã€‚

- **å¸ƒå°”å€¼**ï¼š`bool`

    ```rust
    let is_true: bool = true;
    let is_false = false;
    ```

### char

Rust çš„å­—ç¬¦ç±»å‹ç”¨äºè¡¨ç¤ºå•ä¸ªUnicodeå­—ç¬¦ï¼Œç”¨å•å¼•å·åŒ…è£¹ã€‚

- **å­—ç¬¦**ï¼š`char`

```rust
let c: char = 'A';
let emoji = 'ğŸ˜Š';
```

ä¸åƒå…¶å®ƒè¯­è¨€ï¼Œè¿™æ„å‘³ç€Rustçš„charå¹¶ä¸æ˜¯ 1 ä¸ªå­—èŠ‚ï¼Œè€Œæ˜¯ 4 ä¸ªã€‚

### æ•´æ•°ç±»å‹

Rust æä¾›äº†å¤šç§æ•´æ•°ç±»å‹ï¼ŒåŒ…æ‹¬æœ‰ç¬¦å·å’Œæ— ç¬¦å·æ•´æ•°ã€‚

- **æœ‰ç¬¦å·æ•´æ•°**ï¼š`i8`, `i16`, `i32`, `i64`, `i128`, `isize`
    - èŒƒå›´ï¼š`i8`ï¼ˆ-128 åˆ° 127ï¼‰ï¼Œ`i16`ï¼ˆ-32,768 åˆ° 32,767ï¼‰ï¼Œ`i32`ï¼ˆ-2,147,483,648 åˆ° 2,147,483,647ï¼‰ï¼Œ`i64`å’Œ`i128`å…·æœ‰æ›´å¤§çš„èŒƒå›´ã€‚
    - `isize`ï¼šå¹³å°ç›¸å…³å¤§å°çš„æ•´æ•°ï¼ˆ32ä½æˆ–64ä½ï¼‰ã€‚
- **æ— ç¬¦å·æ•´æ•°**ï¼š`u8`, `u16`, `u32`, `u64`, `u128`, `usize`
    - èŒƒå›´ï¼š`u8`ï¼ˆ0 åˆ° 255ï¼‰ï¼Œ`u16`ï¼ˆ0 åˆ° 65,535ï¼‰ï¼Œ`u32`ï¼ˆ0 åˆ° 4,294,967,295ï¼‰ï¼Œ`u64`å’Œ`u128`å…·æœ‰æ›´å¤§çš„èŒƒå›´ã€‚
    - `usize`ï¼šå¹³å°ç›¸å…³å¤§å°çš„æ— ç¬¦å·æ•´æ•°ã€‚

### æµ®ç‚¹ç±»å‹

Rust æä¾›äº†å•ç²¾åº¦å’ŒåŒç²¾åº¦æµ®ç‚¹ç±»å‹ã€‚

- **å•ç²¾åº¦æµ®ç‚¹æ•°**ï¼š`f32`
- **åŒç²¾åº¦æµ®ç‚¹æ•°**ï¼š`f64`ï¼ˆé»˜è®¤ï¼‰

## å¤åˆç±»å‹

### å…ƒç»„ Tuples

å…ƒç»„å¯ä»¥å°†å¤šä¸ªä¸åŒç±»å‹çš„å€¼ç»„åˆåœ¨ä¸€èµ·ã€‚å…ƒç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ã€‚

```rust
let tup: (i32, f64, u8) = (500, 6.4, 1);
let (x, y, z) = tup; // è§£æ„å…ƒç»„
println!("x: {}, y: {}, z: {}", x, y, z);
```

å¯ä»¥é€šè¿‡ç´¢å¼•è®¿é—®å…ƒç»„ä¸­çš„å€¼,ä¸‹æ ‡æ˜¯ä»0å¼€å§‹ï¼š

```rust
let a = tup.0;
let b = tup.1;
let c = tup.2;
```

### æ•°ç»„

æ•°ç»„åŒ…å«ä¸€ç»„ç›¸åŒç±»å‹çš„å€¼ï¼Œé•¿åº¦æ˜¯å›ºå®šçš„ã€‚

```rust
let arr: [i32; 3] = [1, 2, 3];
let first = arr[0];
let second = arr[1];
```

ä½ è¿˜å¯ä»¥ç”¨ç›¸åŒçš„å€¼åˆå§‹åŒ–æ•°ç»„ï¼š

```rust
let arr = [3; 5]; // ç­‰åŒäº [3, 3, 3, 3, 3]
```

### åˆ‡ç‰‡ Slices

- åˆ‡ç‰‡æ˜¯**å¯¹æ•°ç»„æˆ–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†çš„å¼•ç”¨** æ‰€ä»¥æœ‰`&`

- åˆ‡ç‰‡æ²¡æœ‰æ‰€æœ‰æƒï¼Œåªæ˜¯å€Ÿç”¨æ•°ç»„æˆ–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚
- ä½¿ç”¨èŒƒå›´è¯­æ³•`[start..end]`æ¥åˆ›å»ºåˆ‡ç‰‡ã€‚
- **èµ·å§‹ç´¢å¼•ï¼ˆstartï¼‰**ï¼šåŒ…å«åœ¨åˆ‡ç‰‡ä¸­ï¼Œä»0å¼€å§‹ã€‚
- **ç»“æŸç´¢å¼•ï¼ˆendï¼‰**ï¼šæ’ä»–æ€§çš„ï¼ˆexclusiveï¼‰ï¼Œå³ä¸åŒ…æ‹¬åœ¨åˆ‡ç‰‡ä¸­ã€‚

```rust
let arr = [1, 2, 3, 4, 5];
let slice = &arr[1..3];  // åŒ…å«ç´¢å¼• 1 å’Œ 2 çš„å…ƒç´ ï¼Œå³ 2 å’Œ 3
println!("slice: {:?}", slice); // è¾“å‡º: slice: [2, 3]
```

çœç•¥ç´¢å¼•ï¼š

- **çœç•¥èµ·å§‹ç´¢å¼•**

```rust
let arr = [1, 2, 3, 4, 5];
let slice = &arr[..3]; // ç­‰åŒäº &arr[0..3]
println!("slice: {:?}", slice); // è¾“å‡º: slice: [1, 2, 3]
```

- **çœç•¥ç»“æŸç´¢å¼•**

```rust
let arr = [1, 2, 3, 4, 5];
let slice = &arr[2..]; // ç­‰åŒäº &arr[2..5]
println!("slice: {:?}", slice); // è¾“å‡º: slice: [3, 4, 5]
```

- **çœç•¥èµ·å§‹ç´¢å¼•å’Œç»“æŸç´¢å¼•**

```rust
let arr = [1, 2, 3, 4, 5];
let slice = &arr[..]; // ç­‰åŒäº &arr[0..5]
println!("slice: {:?}", slice); // è¾“å‡º: slice: [1, 2, 3, 4, 5]
```

- **å­—ç¬¦ä¸²åˆ‡ç‰‡**

```rust
let s = String::from("hello world");
let hello = &s[..5]; // ç­‰åŒäº &s[0..5]
let world = &s[6..]; // ç­‰åŒäº &s[6..11]
let whole = &s[..];  // ç­‰åŒäº &s[0..11]
println!("hello: {}", hello); // è¾“å‡º: hello: hello
println!("world: {}", world); // è¾“å‡º: world: world
println!("whole: {}", whole); // è¾“å‡º: whole: hello world
```

### str

`str` æ˜¯å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ï¼Œé€šå¸¸ä»¥å¼•ç”¨çš„å½¢å¼ä½¿ç”¨ï¼Œå³ `&str`ã€‚

1. **å­—ç¬¦ä¸²åˆ‡ç‰‡ (`&str`)**ï¼šä¸å¯å˜çš„å­—ç¬¦ä¸²å¼•ç”¨ï¼Œé€šå¸¸ç”¨æ¥å¼•ç”¨å­—ç¬¦ä¸²å­—é¢é‡æˆ– `String` ç±»å‹çš„æ•°æ®ã€‚
2. **å­—ç¬¦ä¸² (`String`)**ï¼šå¯å˜çš„ã€æ‹¥æœ‰æ‰€æœ‰æƒçš„å­—ç¬¦ä¸²ç±»å‹ï¼Œå…è®¸å­—ç¬¦ä¸²çš„ä¿®æ”¹å’ŒåŠ¨æ€å¢é•¿ã€‚

#### å­—ç¬¦ä¸²åˆ‡ç‰‡ (`&str`)

- å®šä¹‰å­—ç¬¦ä¸²åˆ‡ç‰‡

    ```rust
    let greeting: &str = "Hello, world!";
    println!("{}", greeting);  // è¾“å‡º: Hello, world!
    ```

#### `String` ç±»å‹

- å®šä¹‰å’Œä¿®æ”¹ `String`

    ```rust
    let mut s = String::from("Hello");
    s.push_str(", world!");  // æ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡åˆ° `String` æœ«å°¾
    println!("{}", s);  // è¾“å‡º: Hello, world!
    ```

#### è½¬æ¢

- **`String` è½¬ `&str`**

    ```rust
    let s = String::from("Hello");
    let slice: &str = &s;  // `String` è½¬ `&str`
    println!("{}", slice);  // è¾“å‡º: Hello
    ```

- **`&str` è½¬ `String`**

    ```rust
    let slice: &str = "Hello, world!";
    let s = String::from(slice);  // `&str` è½¬ `String`
    println!("{}", s);  // è¾“å‡º: Hello, world!
    ```

#### ä½¿ç”¨

- å­—ç¬¦ä¸²åˆ‡ç‰‡

    ```rust
    let s = String::from("Hello, world!");
    let hello = &s[0..5];  // åˆ‡ç‰‡ï¼ŒåŒ…å«ç´¢å¼• 0 åˆ° 4 çš„å­—ç¬¦
    let world = &s[7..12];  // åˆ‡ç‰‡ï¼ŒåŒ…å«ç´¢å¼• 7 åˆ° 11 çš„å­—ç¬¦
    println!("hello: {}, world: {}", hello, world);  // è¾“å‡º: hello: Hello, world: world
    ```

#  
